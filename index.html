<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GÃ©nÃ©rateur PowerPoint Professionnel (Offline)</title>
  
  <!-- PptxGenJS Bundle Data (base64 embedded or fallback to external file) -->
  <script id="pptxgen-bundle-data" type="application/octet-stream"><!--PPTX_BUNDLE_BASE64--></script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="./src/css/styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ¯ GÃ©nÃ©rateur PowerPoint Professionnel</h1>
      <p>CrÃ©ez des prÃ©sentations de qualitÃ© en quelques secondes â€” 100% horsâ€‘ligne</p>
    </header>

    <div class="content">
      <div class="instructions">
        <h2>ğŸ“‹ Comment utiliser ce gÃ©nÃ©rateur</h2>
        <ol>
          <li><strong>TÃ©lÃ©chargez</strong> <code>pptxgen.bundle.js</code> et placez-le Ã  cÃ´tÃ© de ce fichier HTML.</li>
          <li><strong>Affichez et copiez</strong> le prompt optimal (bouton ci-dessous), renseignez vos variables (SUJET, AUDIENCE, ...).</li>
          <li><strong>Collez</strong> le JSON gÃ©nÃ©rÃ© par l'IA dans la zone de texte.</li>
          <li><strong>Cliquez</strong> sur Â« GÃ©nÃ©rer PowerPoint Â» pour obtenir le <code>.pptx</code>.</li>
        </ol>
      </div>

      <div class="section">
        <button class="btn" onclick="togglePrompt()">ğŸ“ Afficher le Prompt Optimal</button>
        <div id="promptBox" class="prompt-box" style="display:none;">
          <div class="section-title">Prompt Ã  copier dans votre IA :</div>
          <textarea id="promptText" readonly></textarea>
          <button class="btn copy-btn" onclick="copyPrompt()">ğŸ“‹ Copier le Prompt</button>
          <div id="copyFeedback" role="status" aria-live="polite" data-default-message="âœ“ Prompt copiÃ© dans le presseâ€‘papier !">âœ“ Prompt copiÃ© dans le presseâ€‘papier !</div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">ğŸ“„ Collez ici le JSON gÃ©nÃ©rÃ© par l'IA :</div>
        <textarea id="jsonInput" placeholder='Collez votre JSON ici...'></textarea>
      </div>

      <div class="section">
        <button class="btn" onclick="validateJSONOnly()" style="margin-right: 10px;">
          âœ“ Valider JSON
        </button>
        <button id="generateBtn" class="btn btn-primary" onclick="generatePowerPoint()">
          <span id="genLabel">ğŸš€ GÃ©nÃ©rer PowerPoint</span>
          <span id="genSpin" style="display:none;" class="spinner"></span>
        </button>
      </div>

      <div id="error" class="alert alert-error" role="alert" aria-live="assertive"></div>
      <div id="success" class="alert alert-success" role="status" aria-live="polite"></div>
      <div id="warning" class="alert alert-warning" role="status" aria-live="polite"></div>

      <div class="collapsible">
        <div class="collapsible-header" onclick="toggleCollapsible(this)">
          <span>ğŸ’¡ Exemple JSON Minimal</span><span>â–¼</span>
        </div>
        <div class="collapsible-content">
          <div class="collapsible-body">
<pre>{
  "metadata": {
    "title": "Ma PrÃ©sentation",
    "author": "Votre Nom",
    "company": "Votre Organisation",
    "fileName": "ma-presentation.pptx"
  },
  "slides": [
    {
      "type": "title",
      "title": "Titre Principal",
      "subtitle": "Sous-titre descriptif",
      "backgroundColor": "0066CC",
      "titleColor": "FFFFFF"
    },
    {
      "type": "content",
      "title": "Points ClÃ©s",
      "bullets": [
        "DÃ©finir l'objectif de la prÃ©sentation",
        "Structurer le message en 3 points",
        "Clore avec un appel Ã  l'action"
      ]
    }
  ]
}</pre>
          </div>
        </div>
      </div>

      <div class="collapsible">
        <div class="collapsible-header" onclick="toggleCollapsible(this)">
          <span>ğŸ”§ Types de Slides SupportÃ©s</span><span>â–¼</span>
        </div>
        <div class="collapsible-content">
          <div class="collapsible-body">
            <p><strong>1. title</strong> â€” Page de titre (obligatoirement la 1Ê³áµ‰ slide)</p>
            <p><strong>2. content</strong> â€” Points (3 Ã  5 bullets, â‰¤ 15 mots chacun)</p>
            <p><strong>3. twoColumn</strong> â€” Deux colonnes (2 Ã  4 points par colonne)</p>
            <p><strong>4. table</strong> â€” Tableau (â‰¤ 4 colonnes, â‰¤ 10 lignes)</p>
            <p><strong>5. image</strong> â€” Image <em>offline</em> (data URI <code>data:image/...</code>) ou placeholder <code>IMAGE_PLACEHOLDER_â€¦</code></p>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>
        CrÃ©Ã© avec ğŸ’œ par <strong>GenSpark AI Developer</strong> â€¢ 
        Version 2.1 â€¢ 
        <a href="https://github.com/Guillaume7625/TEST2" target="_blank" rel="noopener">GitHub</a>
      </p>
    </footer>
  </div>

  <!-- Application JavaScript (ES Modules) -->
  <script type="module" src="./src/js/app.js"></script>
</body>
</html>
